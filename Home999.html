<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö AI ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #e9f8ee;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 50px;
      padding: 80px 50px 0;
    }

    /* Enhanced Chat Button with Pulse Animation */
    .chat-btn {
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: linear-gradient(135deg, #18fc4a 0%, #98eb87 100%);
      color: white;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      font-size: 24px;
      z-index: 1001;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      animation: pulse 2s infinite;
      border: none;
      outline: none;
    }

    .chat-btn:hover { transform: translateY(-2px) scale(1.05); box-shadow: 0 12px 30px rgba(102, 126, 234, 0.6); animation: none; }
    .chat-btn:active { transform: translateY(0) scale(0.98); transition: all 0.1s; }
    .chat-btn.clicked { animation: clickPulse 0.3s ease-out; }

    @keyframes pulse {
      0% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
      50% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4), 0 0 0 10px rgba(102, 126, 234, 0.1); }
      100% { box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4), 0 0 0 20px rgba(102, 126, 234, 0); }
    }
    @keyframes clickPulse { 0%{transform:scale(1)} 50%{transform:scale(.9)} 100%{transform:scale(1.05)} }

    /* Enhanced Chat Box with Slide Animation */
    .chat-box {
      position: fixed;
      bottom: 100px;
      right: 20px;
      width: 320px;
      height: 450px;
      background-color: white;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      border-radius: 20px;
      display: none;
      flex-direction: column;
      z-index: 1000;
      overflow: hidden;
      transform: translateY(20px) scale(0.95);
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    .chat-box.show { display: flex; transform: translateY(0) scale(1); opacity: 1; }
    .chat-box.hide { transform: translateY(20px) scale(0.95); opacity: 0; }

    /* Enhanced Header */
    .chat-header {
      background: linear-gradient(135deg, #18fc4a 0%, #98eb87 100%);
      color: rgb(53, 52, 52);
      padding: 15px;
      text-align: center;
      cursor: move;
      font-weight: 600;
      position: relative;
      overflow: hidden;
    }
    .chat-header::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.6s;
    }
    .chat-header:hover::before { left: 100%; }

    /* Enhanced Chat Body */
    .chat-body {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      background: linear-gradient(180deg, #f8f9fa 0%, #ffffff 100%);
      scroll-behavior: smooth;
    }
    .chat-body::-webkit-scrollbar { width: 6px; }
    .chat-body::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px; }
    .chat-body::-webkit-scrollbar-thumb { background: linear-gradient(180deg, #18fc4a, #98eb87); border-radius: 3px; }

    /* Enhanced Message Styling */
    .message { margin-bottom: 12px; padding: 8px 12px; border-radius: 15px; max-width: 85%; animation: fadeInUp 0.4s ease-out; word-wrap: break-word; }
    .message.user { background: linear-gradient(135deg, #18fc4a, #98eb87); color: white; margin-left: auto; border-bottom-right-radius: 5px; }
    .message.ai { background: #e9ecef; color: #333; border-bottom-left-radius: 5px; }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }

    /* Enhanced Chat Footer */
    .chat-footer { display: flex; padding: 15px; background-color: #ffffff; gap: 10px; align-items: flex-end; }
    .chat-footer textarea { flex: 1; padding: 12px; border-radius: 20px; border: 2px solid #e9ecef; resize: none; transition: all 0.3s ease; font-family: inherit; max-height: 100px; }
    .chat-footer textarea:focus { outline: none; border-color: #2de41d; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
    .chat-footer button { background: linear-gradient(135deg, #4be71b, #79db89); color: white; border: none; padding: 12px 16px; border-radius: 20px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; }
    .chat-footer button:hover { transform: translateY(-1px); box-shadow: 0 5px 15px rgba(56, 228, 84, 0.774); }
    .chat-footer button:active { transform: translateY(0); }

    /* Typing indicator */
    .typing-indicator {
      display: none;
      padding: 8px 12px;
      margin-bottom: 12px;
      background: #e9ecef;
      border-radius: 15px;
      border-bottom-left-radius: 5px;
      max-width: 85%;
    }
    .typing-dots { display: flex; gap: 4px; }
    .typing-dots span { height: 8px; width: 8px; background: #2ec933; border-radius: 50%; animation: typing 1.4s infinite ease-in-out both; }
    .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
    .typing-dots span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes typing { 0%,80%,100% { transform: scale(0.8); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }

    /* Bottom Navigation */
    .button-container-bottom {
      position: fixed; bottom: 0; left: 0; width: 100%;
      display: flex; justify-content: space-around; gap: 10px;
      background-color: white; padding: 8px 0; box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.1);
      z-index: 1000;
    }
    .btn-bottom {
      background-color: transparent; border: none; cursor: pointer; flex: 1; height: 60px;
      display: flex; align-items: center; justify-content: center; overflow: hidden; padding: 0;
      text-decoration: none; transition: all 0.3s ease; box-shadow: none;
    }
    .btn-bottom img { width: 80px; height: auto; object-fit: contain; display: block; }
    .btn-bottom:hover { transform: scale(1.05); }
    .btn-bottom:active { transform: scale(0.98); }

    /* Logo (if any) */
    .logo-container img { width: 100%; height: 100%; object-fit: contain; }

    .box-container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; width: 100%; max-width: 340px; }
    .box { background-color: white; padding: 30px; border-radius: 30px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); text-align: center; width: 100%; max-width: 340px; }

    #weatherBox { background-color: #e0f7ff; border-left: 4px solid #1100ff; }
    #weatherInfo { margin-top: 10px; font-size: 16px; color: #555; }

    .greeting-box {
      position: fixed; top: 20px; left: 20px;
      background-color: #fffbe8; border-left: 4px solid #f1c40f; padding: 10px 20px;
      border-radius: 12px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000; font-size: 16px; font-weight: bold; color: #333; pointer-events: none;
    }

    .button-container-bottom {
    position: fixed;
    bottom: 0;
    left: 0; /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡∏°‡πà */
    width: 100%; /* ‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
    display: flex;
    justify-content: space-around; /* ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡πÜ ‡∏Å‡∏±‡∏ô */
    gap: 10px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° */
    background-color: white;
    padding: 8px 0;
    box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.1);
    z-index: 1000;
}

.btn-bottom {
    background-color: transparent; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ */
    border: none;                 /* ‡∏•‡∏ö‡∏Ç‡∏≠‡∏ö */
    cursor: pointer;
    flex: 1;                     /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà */
    height: 60px;                /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏° */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    padding: 0;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: none;             /* ‡∏•‡∏ö‡πÄ‡∏á‡∏≤ */
}

.btn-bottom img {
    width: 80px;                 /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° */
    height: auto;
    object-fit: contain;
    display: block;
}

.btn-bottom:hover {
    transform: scale(1.05);
}

.btn-bottom:active {
    transform: scale(0.98);
}
        /* ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πà‡∏≤‡∏á */
        
        .btn-bottom.home {
            background-color: #ffffff;
        }
        
        .btn-bottom.ai {
            background-color: #ffffff;
        }
        
        .btn-bottom.plant {
            background-color: #ffffff;
        }
        
        .btn-bottom.menu {
            background-color: #ffffff;
        }
        
        .btn-bottom {
            background-color: white;
            color: #333;
            padding: 0;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            border-radius: 0;
            box-shadow: none;
        }
        
        .btn-bottom img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .btn-bottom:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }
        
        .btn-bottom:active {
            transform: scale(0.98);
        }
        
        .btn-bottom.home {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-bottom.ai {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-bottom.plant {
            background-color: #007bff;
            color: white;
        }
        
        .btn-bottom.menu {
            background-color: #ff9900;
            color: white;
        }
  </style>
</head>

<body>
  <!-- ‡∏õ‡πâ‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ -->
  <div class="greeting-box" id="greetingBox">
    <p>üßë‚Äçüåæ <span id="greetingText">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ</span></p>
  </div>

  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
  <div class="box-container">
    <div class="box" id="priceBox">
      <h2>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡∏•‡πÑ‡∏°‡πâ</h2>
      <p>‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î 10 ‡∏ö‡∏≤‡∏ó</p>
      <p>‡πÄ‡∏á‡∏≤‡∏∞‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 10 ‡∏ö‡∏≤‡∏ó</p>
      <p>‡πÄ‡∏á‡∏≤‡∏∞‡∏™‡∏µ‡∏ó‡∏≠‡∏á 10 ‡∏ö‡∏≤‡∏ó</p>
      <p>‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 10 ‡∏ö‡∏≤‡∏ó</p>
    </div>

    <div class="box" id="newsBox">
      <h2>üì∞ ‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£</h2>
      <div id="newsContent">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πà‡∏≤‡∏ß...</div>
    </div>

    <div id="weatherBox" class="box">
      <h2>üå§Ô∏è ‡∏™‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</h2>
      <div id="weatherInfo"><p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p></div>
    </div>
  </div>

  <!-- Enhanced Chat Button -->
  <div class="chat-btn" onclick="toggleChat()" id="chatBtn">üí¨</div>

  <!-- Enhanced Chat Box -->
  <div class="chat-box" id="chatBox">
    <div class="chat-header">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</div>
    <div class="chat-body" id="chatBody">
      <div class="message ai">‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ üòä</div>
    </div>
    <div class="typing-indicator" id="typingIndicator">
      <div class="typing-dots"><span></span><span></span><span></span></div>
    </div>
    <div class="chat-footer">
      <textarea id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." rows="1" onkeypress="handleKeyPress(event)"></textarea>
      <button onclick="sendMessage()">‡∏™‡πà‡∏á</button>
    </div>
  </div>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πà‡∏≤‡∏á -->
  <div class="button-container-bottom">
    <a href="Home999.html" class="btn-bottom">
      <img src="60.png" alt="Home">
    </a>
    <a href="shop.html" class="btn-bottom">
      <img src="1000.png" alt="‡πÄ‡∏°‡∏ô‡∏π">
    </a>
    <a href="Home.html" class="btn-bottom">
      <img src="61.png" alt="AI">
    </a>
    <a href="Home555.html" class="btn-bottom">
      <img src="62.png" alt="‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡∏•‡∏π‡∏Å">
    </a>
    <a href="menu.html" class="btn-bottom">
      <img src="1000.png" alt="‡πÄ‡∏°‡∏ô‡∏π">
    </a>
  </div>

  <!-- JavaScript -->
  <script>
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏≥‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢
    (function(){
      const h = new Date().getHours();
      document.getElementById("greetingText").textContent =
        h < 11 ? "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ üåÖ" :
        h < 15 ? "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô ‚òÄÔ∏è" :
        h < 19 ? "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡πÄ‡∏¢‡πá‡∏ô üåá" : "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏ï‡∏≠‡∏ô‡∏Ñ‡πà‡∏≥ üåô";
    })();

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πà‡∏≤‡∏ß‡∏à‡∏≤‡∏Å ThaiPBS (‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß)
    async function loadRSS() {
      const rssUrl = "https://www.thaipbs.or.th/agriculture/feed";
      const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;

      try {
        const res = await fetch(apiUrl);
        const data = await res.json();

        if (!data.items || data.items.length === 0) {
          document.getElementById("newsContent").innerText = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πà‡∏≤‡∏ß‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ";
          return;
        }

        let html = "<ul class='feed'>";
        data.items.slice(0, 5).forEach(item => {
          html += `
            <li>
              <a href="${item.link}" target="_blank" rel="noopener">${item.title}</a><br>
              <span class="feedDate">${new Date(item.pubDate).toLocaleDateString('th-TH')}</span>
            </li>`;
        });
        html += "</ul>";
        document.getElementById("newsContent").innerHTML = html;
      } catch (err) {
        document.getElementById("newsContent").innerText = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πà‡∏≤‡∏ß";
        console.error("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err);
      }
    }

    // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡∏•‡πÑ‡∏°‡πâ‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå (‡πÅ‡∏Å‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ)
    async function loadFruitPricesRealtime() {
      try {
        const fruitPrices = await new Promise(resolve => {
          setTimeout(() => {
            resolve({
              "‡πÄ‡∏á‡∏≤‡∏∞‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô": (32.5).toFixed(2) + " ‡∏ö‡∏≤‡∏ó/‡∏Å‡∏Å.",
              "‡πÄ‡∏á‡∏≤‡∏∞‡∏™‡∏µ‡∏ó‡∏≠‡∏á": (27).toFixed(2) + " ‡∏ö‡∏≤‡∏ó/‡∏Å‡∏Å.",
            });
          }, 500);
        });

        let html = "<h2>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡∏•‡πÑ‡∏°‡πâ</h2><ul>";
        Object.keys(fruitPrices).forEach(fruit => {
          html += `<li><strong>${fruit}:</strong> ${fruitPrices[fruit]}</li>`;
        });
        html += "</ul>";

        document.getElementById("priceBox").innerHTML = html;
      } catch (error) {
        document.getElementById("priceBox").innerHTML = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡∏•‡πÑ‡∏°‡πâ‡πÑ‡∏î‡πâ";
        console.error("Error fetching fruit prices:", error);
      }
    }

    // ====== CHAT (‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå ‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API/‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤) ======
    let chatOpen = false;

    function toggleChat() {
      const chatBtn = document.getElementById("chatBtn");
      const chatBox = document.getElementById("chatBox");

      chatBtn.classList.add("clicked");
      setTimeout(() => chatBtn.classList.remove("clicked"), 300);

      chatOpen = !chatOpen;

      if (chatOpen) {
        chatBox.style.display = 'flex';
        setTimeout(() => chatBox.classList.add("show"), 10);
        chatBox.classList.remove("hide");

        setTimeout(() => {
          document.getElementById("chatInput").focus();
        }, 400);
      } else {
        chatBox.classList.add("hide");
        chatBox.classList.remove("show");
        setTimeout(() => { if (!chatOpen) chatBox.style.display = 'none'; }, 400);
      }
    }

    async function sendMessage() {
      const inputEl = document.getElementById("chatInput");
      const text = inputEl.value.trim();
      if (!text) return;

      appendMessage("user", text);
      inputEl.value = "";

      showTypingIndicator();
      await new Promise(r => setTimeout(r, 400)); // ‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î

      const aiResponse = await fetchAIResponse(text); // ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå
      hideTypingIndicator();
      setTimeout(() => { appendMessage("ai", aiResponse); }, 150);
    }

    function appendMessage(sender, message) {
      const chatBody = document.getElementById("chatBody");
      const messageDiv = document.createElement("div");
      messageDiv.className = `message ${sender}`;
      messageDiv.textContent = message;
      chatBody.appendChild(messageDiv);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showTypingIndicator() {
      const indicator = document.getElementById("typingIndicator");
      const chatBody = document.getElementById("chatBody");
      indicator.style.display = 'block';
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function hideTypingIndicator() {
      document.getElementById("typingIndicator").style.display = 'none';
    }

    function handleKeyPress(event) {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    }

    // ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏° fetchAIResponse ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÅ‡∏•‡πâ‡∏ß
    async function fetchAIResponse(userInput) {
      return localSmartReply(userInput);
    }

    // ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ ‡πÜ (‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ)
    function localSmartReply(raw) {
      const text = raw.toLowerCase().trim();

      // 1) ‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢
      if (/(‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ|hello|hi|‡πÄ‡∏Æ‡∏•‡πÇ‡∏´‡∏•)/.test(text)) {
        const hi = ["‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö üëã", "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏≤ üëã", "‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ! üòä"];
        return hi[Math.floor(Math.random() * hi.length)] + " ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°?";
      }

      // 2) ‡πÄ‡∏ß‡∏•‡∏≤/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
      if (/(‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á|‡πÄ‡∏ß‡∏•‡∏≤|time)/.test(text)) {
        const t = new Date().toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
        return `‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ${t} ‡∏ô.`;
      }
      if (/(‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà|‡∏ß‡∏±‡∏ô‡∏≠‡∏∞‡πÑ‡∏£|date)/.test(text)) {
        const d = new Date().toLocaleDateString('th-TH', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        return `‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ ${d}`;
      }

      // 3) ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏±‡∏ß
      if (/(‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£|‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£|‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á|‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏î‡πâ)/.test(text)) {
        return "‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ö‡∏ö‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ, ‡∏ö‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤/‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡πÄ‡∏•‡πà‡∏ô‡∏°‡∏∏‡∏Å‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥‡πÑ‡∏î‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ üòä";
      }

      // 4) ‡∏°‡∏∏‡∏Å‡∏ï‡∏•‡∏Å
      if (/(‡∏°‡∏∏‡∏Å|‡∏Ç‡∏≥|‡∏ï‡∏•‡∏Å|‡∏Ç‡∏≥‡∏Ç‡∏±‡∏ô)/.test(text)) {
        const jokes = [
          "‡∏ó‡∏≥‡πÑ‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡πå‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡∏≤‡∏ß? ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏ß‡∏¥‡∏ô‡πÇ‡∏î‡∏ß‡∏™‡πå ü•∂",
          "‡∏ú‡∏±‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡∏ä‡∏≠‡∏ö‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô? ‡∏ö‡∏ß‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô üòÖ",
          "‡∏õ‡∏•‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏ä‡∏≠‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏î‡πá‡∏Å? ‡∏õ‡∏•‡∏≠‡∏ö‡πÉ‡∏à ü§≠"
        ];
        return jokes[Math.floor(Math.random() * jokes.length)];
      }

      // 5) ‡∏ó‡∏¥‡∏õ‡∏õ‡∏•‡∏π‡∏Å‡∏û‡∏∑‡∏ä‡∏á‡πà‡∏≤‡∏¢ ‡πÜ
      if (/(‡∏õ‡∏•‡∏π‡∏Å|‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡∏•‡∏π‡∏Å)/.test(text)) {
        return "‡∏ó‡∏¥‡∏õ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô: ‡∏î‡∏¥‡∏ô‡πÇ‡∏õ‡∏£‡πà‡∏á‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏î‡∏µ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡πÑ‡∏°‡πà‡πÅ‡∏â‡∏∞ ‡πÉ‡∏´‡πâ‡πÅ‡∏î‡∏î‡∏ï‡∏≤‡∏°‡∏ä‡∏ô‡∏¥‡∏î‡∏û‡∏∑‡∏ä ‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞ üå±";
      }

      // 6) ‡∏™‡∏∞‡∏Å‡∏î‡∏Ñ‡∏≥‡∏á‡πà‡∏≤‡∏¢ ‡πÜ
      if (/^‡∏™‡∏∞‡∏Å‡∏î|^spell/.test(text)) {
        const word = raw.replace(/^‡∏™‡∏∞‡∏Å‡∏î|^spell/i, "").trim();
        if (!word) return "‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏™‡∏∞‡∏Å‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üôÇ";
        return `‡∏™‡∏∞‡∏Å‡∏î‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß: ${word.split("").join(" ‚Ä¢ ")}`;
      }

      // 7) ‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
      if (text.length <= 4) return "‡πÇ‡∏≠‡πÄ‡∏Ñ‡∏Ñ‡∏£‡∏±‡∏ö üôÇ";
      return `‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö: ‚Äú${raw}‚Äù ‡∏´‡∏≤‡∏Å‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á ‡∏•‡∏≠‡∏á‡∏ö‡∏≠‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö`;
    }

    // Enhanced dragging functionality (‡πÄ‡∏î‡∏¥‡∏°)
    const chatBox = document.getElementById("chatBox");
    const chatHeader = document.querySelector(".chat-header");
    let isDragging = false;
    let offsetX, offsetY;

    chatHeader.addEventListener("mousedown", (e) => {
      isDragging = true;
      offsetX = e.clientX - chatBox.getBoundingClientRect().left;
      offsetY = e.clientY - chatBox.getBoundingClientRect().top;
      document.addEventListener("mousemove", dragChatBox);
      document.addEventListener("mouseup", stopDragging);
      chatBox.style.transition = 'none'; // Disable transition while dragging
    });

    function dragChatBox(e) {
      if (isDragging) {
        chatBox.style.left = `${e.clientX - offsetX}px`;
        chatBox.style.top = `${e.clientY - offsetY}px`;
      }
    }

    function stopDragging() {
      isDragging = false;
      document.removeEventListener("mousemove", dragChatBox);
      document.removeEventListener("mouseup", stopDragging);
      chatBox.style.transition = ''; // Re-enable transitions
    }

    // Enhanced button dragging (‡πÄ‡∏î‡∏¥‡∏°)
    const chatBtn = document.getElementById("chatBtn");
    let isBtnDragging = false;
    let btnOffsetX, btnOffsetY;

    chatBtn.addEventListener("mousedown", (e) => {
      isBtnDragging = true;
      btnOffsetX = e.clientX - chatBtn.getBoundingClientRect().left;
      btnOffsetY = e.clientY - chatBtn.getBoundingClientRect().top;
      document.addEventListener("mousemove", dragChatBtn);
      document.addEventListener("mouseup", stopBtnDragging);
      chatBtn.style.transition = 'none';
    });

    function dragChatBtn(e) {
      if (isBtnDragging) {
        chatBtn.style.left = `${e.clientX - btnOffsetX}px`;
        chatBtn.style.top = `${e.clientY - btnOffsetY}px`;
      }
    }

    function stopBtnDragging() {
      isBtnDragging = false;
      document.removeEventListener("mousemove", dragChatBtn);
      document.removeEventListener("mouseup", stopBtnDragging);
      chatBtn.style.transition = '';
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    loadRSS();
    loadFruitPricesRealtime();
    setInterval(loadFruitPricesRealtime, 60000); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ
  </script>

  <script src="name.js"></script>
  <script src="script.js"></script>
</body>
</html>
